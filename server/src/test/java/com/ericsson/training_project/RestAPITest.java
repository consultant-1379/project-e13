package com.ericsson.training_project;

import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;
import org.mockito.InjectMocks;
import org.mockito.Mock;
import org.mockito.MockitoAnnotations;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.boot.test.web.client.TestRestTemplate;
import org.springframework.http.*;
import org.springframework.mock.web.MockMultipartFile;
import org.springframework.web.multipart.MultipartFile;


import java.io.*;
import java.nio.charset.StandardCharsets;
import java.util.Arrays;
import java.util.Collection;
import java.util.Date;
import java.util.List;

import static org.junit.jupiter.api.Assertions.*;
import static org.mockito.Mockito.*;

@SpringBootTest(webEnvironment=SpringBootTest.WebEnvironment.RANDOM_PORT)
public class RestAPITest {

    @InjectMocks
    private RestAPI restAPI;

    @Autowired
    private TestRestTemplate restTemplate;

    @Mock
    private CsvRepositoryImpl repo;

    @BeforeEach
    public void setUp() {
        MockitoAnnotations.openMocks(this);
    }

    @Test
    public void testGetAllDataByDate() {
        Date date = new Date();
        CSV csv1 = new CSV("https://example.com/csv", date, 10, 20, 5,
                15, 30, 25, 3, 8,
                "Contributors", "Small Contributors", 7, "Commit Data");

        CSV csv2 = new CSV("https://example.com/csv", date, 5, 300, 9,
                4, 12, 70, 2, 9,
                "Contributors", "Small Contributors", 7, "Commit Data");

        List<CSV> mockCsvList = Arrays.asList(csv1,csv2);
        when(repo.getCSVs()).thenReturn(mockCsvList);

        ResponseEntity<Collection<CSV>> responseEntity = restAPI.getAllDataByDate();

        assertEquals(HttpStatus.OK, responseEntity.getStatusCode());
        assertEquals(2, responseEntity.getBody().size());
        assertEquals(mockCsvList, responseEntity.getBody());
    }

    @Test
    public void testGetDataByUrl() throws Exception {
        Date date = new Date();
        String url = "https://example.com/csv";
        CSV csv1 = new CSV(url, date, 10, 20, 5,
                15, 30, 25, 3, 8,
                "Contributors", "Small Contributors", 7, "Commit Data");

        CSV csv2 = new CSV(url, date, 5, 300, 9,
                4, 12, 70, 2, 9,
                "Contributors", "Small Contributors", 7, "Commit Data");

        Collection<CSV> mockCsvCollection = Arrays.asList(csv1, csv2);

        List<CSV> mockCsvList = Arrays.asList(csv1,csv2);
        when(repo.getCsvByUrl(csv1.getUrl())).thenReturn(mockCsvList);

        repo.insertCSV(csv1);
        repo.insertCSV(csv2);

        ResponseEntity<Collection<CSV>> responseEntity = restAPI.getDataByUrl(url);

        assertEquals(HttpStatus.OK, responseEntity.getStatusCode());
        assertEquals(2, responseEntity.getBody().size());
        assertEquals(mockCsvList, responseEntity.getBody());

    }

    @Test
    public void testUploadFile_Success() {

        Long currentCount = repo.countCSVs();

        String csvContent = """ 
url,commits,linesadded,linesremoved,avgchangeset,maxchangeset,avgcodechurn,maxcodechurn,contributorsnum,bigcontributors,smallcontributors,hunkscount,commitdata
https://github.com/Vasu7389/react-project-ideas,35,138977,3216,15.371428571428572,207,3878.885714285714,25063,3,"{'Vasu7389': 24, 'Vasu Awasthi': 10}",{'Rahul Dange': 1},142167,"[{'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': 'fa9228aaa5e63f0724ffd1219b7695e54966feee', 'commitauthor': 'Vasu7389', 'commitauthoremail': '52382687+Vasu7389@users.noreply.github.com', 'commitauthordate': '2022-09-15 11:02:12', 'commitauthortimezone': -19800, 'commitlinesadded': 22, 'commitlinesremoved': 0, 'commitinmain': True, 'commitmessage': 'Initial commit'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': '5ac2baa1c5a896bb8a7ee4279b950128e0a29c68', 'commitauthor': 'Vasu7389', 'commitauthoremail': 'awasthivasu.65@gmail.com', 'commitauthordate': '2022-09-15 11:10:13', 'commitauthortimezone': -19800, 'commitlinesadded': 390, 'commitlinesremoved': 0, 'commitinmain': True, 'commitmessage': 'react30 day1 & day2 articles'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': '4cafbfa02cc367541b4a7fb4c0d4b6446b137457', 'commitauthor': 'Vasu7389', 'commitauthoremail': 'awasthivasu.65@gmail.com', 'commitauthordate': '2022-09-15 11:26:56', 'commitauthortimezone': -19800, 'commitlinesadded': 22, 'commitlinesremoved': 0, 'commitinmain': True, 'commitmessage': ""Merge branch 'master' of https://github.com/Vasu7389/react30""}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': '64f1500186b55e9a5fcc249e9f97bd3b58a4efe8', 'commitauthor': 'Vasu7389', 'commitauthoremail': '52382687+Vasu7389@users.noreply.github.com', 'commitauthordate': '2022-09-15 11:42:40', 'commitauthortimezone': -19800, 'commitlinesadded': 0, 'commitlinesremoved': 389, 'commitinmain': True, 'commitmessage': 'Delete day2 directory'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': '2c46cefb703d411c4e6c33cd72e7af9e4c3d32c7', 'commitauthor': 'Vasu7389', 'commitauthoremail': '52382687+Vasu7389@users.noreply.github.com', 'commitauthordate': '2022-09-15 11:42:48', 'commitauthortimezone': -19800, 'commitlinesadded': 0, 'commitlinesremoved': 1, 'commitinmain': True, 'commitmessage': 'Delete day1 directory'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': '859cb16ce970eb8c0bca67ed16c78bfd75041d55', 'commitauthor': 'Vasu7389', 'commitauthoremail': 'awasthivasu.65@gmail.com', 'commitauthordate': '2022-09-15 11:43:43', 'commitauthortimezone': -19800, 'commitlinesadded': 25063, 'commitlinesremoved': 0, 'commitinmain': True, 'commitmessage': 'day1 & day2 added'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': 'f9996d40aa5bcbc86268d930c3c0cc10c2e4387b', 'commitauthor': 'Vasu7389', 'commitauthoremail': 'awasthivasu.65@gmail.com', 'commitauthordate': '2022-09-15 11:46:01', 'commitauthortimezone': -19800, 'commitlinesadded': 1, 'commitlinesremoved': 0, 'commitinmain': True, 'commitmessage': 'added gitignore'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': '101aa444ac9b53874510e2059332144381161122', 'commitauthor': 'Vasu7389', 'commitauthoremail': '52382687+Vasu7389@users.noreply.github.com', 'commitauthordate': '2022-09-15 11:48:43', 'commitauthortimezone': -19800, 'commitlinesadded': 3, 'commitlinesremoved': 1, 'commitinmain': True, 'commitmessage': 'Update README.md'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': '1eaa28799994ff234e986638a849ec44ad40d25e', 'commitauthor': 'Vasu7389', 'commitauthoremail': 'awasthivasu.65@gmail.com', 'commitauthordate': '2022-09-15 13:59:48', 'commitauthortimezone': -19800, 'commitlinesadded': 12683, 'commitlinesremoved': 1, 'commitinmain': True, 'commitmessage': 'day 3 challenge added'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': '2338ae1dc0de8f3d83b0fafeef2969c756625f0b', 'commitauthor': 'Vasu7389', 'commitauthoremail': 'awasthivasu.65@gmail.com', 'commitauthordate': '2022-09-15 14:00:03', 'commitauthortimezone': -19800, 'commitlinesadded': 3, 'commitlinesremoved': 1, 'commitinmain': True, 'commitmessage': ""Merge branch 'master' of https://github.com/Vasu7389/react30""}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': 'b72ef01de0cca9bf26a34cbc66a6070cf6e0917a', 'commitauthor': 'Vasu7389', 'commitauthoremail': 'awasthivasu.65@gmail.com', 'commitauthordate': '2022-09-16 13:29:28', 'commitauthortimezone': -19800, 'commitlinesadded': 17648, 'commitlinesremoved': 0, 'commitinmain': True, 'commitmessage': 'day 4 added'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': '6e382170eee2e1c5a8ca1adbfecf1768ba94630e', 'commitauthor': 'Vasu7389', 'commitauthoremail': 'awasthivasu.65@gmail.com', 'commitauthordate': '2022-09-18 04:35:18', 'commitauthortimezone': -19800, 'commitlinesadded': 12791, 'commitlinesremoved': 0, 'commitinmain': True, 'commitmessage': 'day 5 added'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': '3d7d1428aa196e256c1d7046ff43a6fe17a48bc0', 'commitauthor': 'Vasu7389', 'commitauthoremail': 'awasthivasu.65@gmail.com', 'commitauthordate': '2022-09-21 07:06:44', 'commitauthortimezone': -19800, 'commitlinesadded': 12574, 'commitlinesremoved': 0, 'commitinmain': True, 'commitmessage': 'day6 added'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': 'd18b5e88b2be9b02000ee86d0611b4ada53c27c7', 'commitauthor': 'Vasu7389', 'commitauthoremail': 'awasthivasu.65@gmail.com', 'commitauthordate': '2022-10-24 05:15:01', 'commitauthortimezone': -19800, 'commitlinesadded': 12500, 'commitlinesremoved': 0, 'commitinmain': True, 'commitmessage': 'day7 challenge added'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': '64288c91c536ca3652b36492f344e66b8da45714', 'commitauthor': 'Vasu7389', 'commitauthoremail': 'awasthivasu.65@gmail.com', 'commitauthordate': '2022-10-24 05:17:02', 'commitauthortimezone': -19800, 'commitlinesadded': 192, 'commitlinesremoved': 0, 'commitinmain': True, 'commitmessage': 'day7 assets added'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': 'f29058f550969c132a487c41cc8c2b34b65b4b39', 'commitauthor': 'Vasu7389', 'commitauthoremail': 'awasthivasu.65@gmail.com', 'commitauthordate': '2022-10-25 13:16:05', 'commitauthortimezone': -19800, 'commitlinesadded': 12631, 'commitlinesremoved': 0, 'commitinmain': True, 'commitmessage': 'day8 challenge added'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': '5e04bb07bef7af84601c67cb57e329c84429a15b', 'commitauthor': 'Vasu7389', 'commitauthoremail': 'awasthivasu.65@gmail.com', 'commitauthordate': '2022-10-25 13:28:54', 'commitauthortimezone': -19800, 'commitlinesadded': 2, 'commitlinesremoved': 2, 'commitinmain': True, 'commitmessage': 'about us added'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': 'e98aae0c5c3e2f075e5f80635905e05fc1e8484c', 'commitauthor': 'Vasu7389', 'commitauthoremail': 'awasthivasu.65@gmail.com', 'commitauthordate': '2022-10-25 13:30:09', 'commitauthortimezone': -19800, 'commitlinesadded': 1, 'commitlinesremoved': 1, 'commitinmain': True, 'commitmessage': 'codinn link added'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': 'b82a6c77d28603db991650cd8efdfbfc8791e9e3', 'commitauthor': 'Vasu7389', 'commitauthoremail': 'awasthivasu.65@gmail.com', 'commitauthordate': '2022-10-27 13:01:42', 'commitauthortimezone': -19800, 'commitlinesadded': 1, 'commitlinesremoved': 1, 'commitinmain': True, 'commitmessage': 'readme updated'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': '7c77dcc71e89720a82dc1d1f373e15e49bdeee25', 'commitauthor': 'Vasu7389', 'commitauthoremail': 'awasthivasu.65@gmail.com', 'commitauthordate': '2022-10-28 17:03:35', 'commitauthortimezone': -19800, 'commitlinesadded': 14200, 'commitlinesremoved': 0, 'commitinmain': True, 'commitmessage': 'day9 added'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': '8c6fe6d1c8d97cfd80308fabd5e130fad068616b', 'commitauthor': 'Vasu Awasthi', 'commitauthoremail': '52382687+Vasu7389@users.noreply.github.com', 'commitauthordate': '2022-10-29 05:35:12', 'commitauthortimezone': -19800, 'commitlinesadded': 51, 'commitlinesremoved': 1, 'commitinmain': True, 'commitmessage': 'readme updated'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': '0dcafd74b0dbdb8b1d4fca4ba0c5e7822838b4ed', 'commitauthor': 'Vasu7389', 'commitauthoremail': 'awasthivasu.65@gmail.com', 'commitauthordate': '2022-10-29 05:40:10', 'commitauthortimezone': -19800, 'commitlinesadded': 0, 'commitlinesremoved': 2769, 'commitinmain': True, 'commitmessage': 'removed all the assets'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': '3473147f768650cf3723c1337cc57358ae6c1112', 'commitauthor': 'Vasu7389', 'commitauthoremail': 'awasthivasu.65@gmail.com', 'commitauthordate': '2022-11-09 14:01:37', 'commitauthortimezone': -19800, 'commitlinesadded': 19, 'commitlinesremoved': 9, 'commitinmain': True, 'commitmessage': 'demo link updated'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': '4981c82c2b2226af3a38727e6fb79e5d472e10ae', 'commitauthor': 'Vasu Awasthi', 'commitauthoremail': '52382687+Vasu7389@users.noreply.github.com', 'commitauthordate': '2022-11-12 11:12:43', 'commitauthortimezone': -19800, 'commitlinesadded': 128, 'commitlinesremoved': 0, 'commitinmain': True, 'commitmessage': 'Create CODE_OF_CONDUCT.md'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': '9aa6220baf9a211f0baec40f07ac52fd02af58c7', 'commitauthor': 'Vasu Awasthi', 'commitauthoremail': '52382687+Vasu7389@users.noreply.github.com', 'commitauthordate': '2022-11-12 11:59:58', 'commitauthortimezone': -19800, 'commitlinesadded': 30, 'commitlinesremoved': 0, 'commitinmain': True, 'commitmessage': 'Create CONTRIBUTING.md'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': '8d01013c47a6dffa98d7b786e456e2719601a701', 'commitauthor': 'Vasu Awasthi', 'commitauthoremail': '52382687+Vasu7389@users.noreply.github.com', 'commitauthordate': '2022-11-12 12:02:00', 'commitauthortimezone': -19800, 'commitlinesadded': 5, 'commitlinesremoved': 0, 'commitinmain': True, 'commitmessage': 'Create SECURITY.md'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': '3c2926b0c91c7195c286b93523cd23d70ab64db9', 'commitauthor': 'Vasu Awasthi', 'commitauthoremail': '52382687+Vasu7389@users.noreply.github.com', 'commitauthordate': '2022-11-13 04:26:39', 'commitauthortimezone': -19800, 'commitlinesadded': 9, 'commitlinesremoved': 9, 'commitinmain': True, 'commitmessage': 'Update README.md'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': '09275edf66f1064b2186058b00f639c873dad9d6', 'commitauthor': 'Vasu Awasthi', 'commitauthoremail': '52382687+Vasu7389@users.noreply.github.com', 'commitauthordate': '2022-11-15 13:51:26', 'commitauthortimezone': -19800, 'commitlinesadded': 2, 'commitlinesremoved': 0, 'commitinmain': True, 'commitmessage': 'Update README.md'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': 'd3d7b9090ccc35029829acecb78dd421894af0c4', 'commitauthor': 'Vasu7389', 'commitauthoremail': 'awasthivasu.65@gmail.com', 'commitauthordate': '2022-11-17 12:22:14', 'commitauthortimezone': -19800, 'commitlinesadded': 17970, 'commitlinesremoved': 0, 'commitinmain': True, 'commitmessage': 'day10 added'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': '7e1011cdcdec4dd7c4a3efce8899aade2afb51ae', 'commitauthor': 'Vasu7389', 'commitauthoremail': 'awasthivasu.65@gmail.com', 'commitauthordate': '2022-11-17 12:49:50', 'commitauthortimezone': -19800, 'commitlinesadded': 0, 'commitlinesremoved': 0, 'commitinmain': True, 'commitmessage': 'folder renamed'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': '0f7ad7c042c78d09dbcee0c0030ab210ab2bfde6', 'commitauthor': 'Vasu Awasthi', 'commitauthoremail': '52382687+Vasu7389@users.noreply.github.com', 'commitauthordate': '2022-11-17 14:14:38', 'commitauthortimezone': -19800, 'commitlinesadded': 14, 'commitlinesremoved': 9, 'commitinmain': True, 'commitmessage': 'Update README.md'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': '435cbb49a1dd17cbeb572c37f421ec751582dea0', 'commitauthor': 'Vasu Awasthi', 'commitauthoremail': '52382687+Vasu7389@users.noreply.github.com', 'commitauthordate': '2022-11-18 15:25:54', 'commitauthortimezone': -19800, 'commitlinesadded': 10, 'commitlinesremoved': 10, 'commitinmain': True, 'commitmessage': 'Update README.md'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': 'daa9e5befb5838f0b40d168f7853ce790342f036', 'commitauthor': 'Vasu Awasthi', 'commitauthoremail': '52382687+Vasu7389@users.noreply.github.com', 'commitauthordate': '2022-12-13 07:04:14', 'commitauthortimezone': -19800, 'commitlinesadded': 10, 'commitlinesremoved': 10, 'commitinmain': True, 'commitmessage': 'Project demo path updated'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': '197ef4010560447e76d31899fd572b9d15474682', 'commitauthor': 'Vasu Awasthi', 'commitauthoremail': '52382687+Vasu7389@users.noreply.github.com', 'commitauthordate': '2023-02-24 10:14:04', 'commitauthortimezone': -19800, 'commitlinesadded': 1, 'commitlinesremoved': 1, 'commitinmain': True, 'commitmessage': 'Update README.md'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': '0496cf49a5bac64c4a5a07371f7fcbb9ac6df195', 'commitauthor': 'Rahul Dange', 'commitauthoremail': 'rahuldangeofficial@gmail.com', 'commitauthordate': '2023-07-09 06:19:46', 'commitauthortimezone': -19800, 'commitlinesadded': 1, 'commitlinesremoved': 1, 'commitinmain': True, 'commitmessage': 'Fix typo at line 70\n\nMT -> MIT'}]"
        """;
        MockMultipartFile file = new MockMultipartFile("file", "test.csv", "text/csv", csvContent.getBytes(StandardCharsets.UTF_8));


        ResponseEntity<String> response = restAPI.uploadFile(file);

        assertEquals(200, response.getStatusCodeValue());
        assertEquals("File uploaded successfully", response.getBody());
        System.out.println(repo.countCSVs());
    }

    @Test
    public void testUploadFile_EmptyFile() {
        RestAPI sampleController = new RestAPI();
        MultipartFile emptyFile = new MockMultipartFile("file", "empty.csv", "text/plain", new byte[0]);
        Long currentCount = repo.countCSVs();

        ResponseEntity<String> response = sampleController.uploadFile(emptyFile);

        assertEquals(400, response.getStatusCodeValue());
        assertEquals("Please upload a file.", response.getBody());
    }

    @Test
    public void testProcessCSVFile() throws IOException {
        // Create a mock CSV file content
        String csvContent = """ 
            url,commits,linesadded,linesremoved,avgchangeset,maxchangeset,avgcodechurn,maxcodechurn,contributorsnum,bigcontributors,smallcontributors,hunkscount,commitdata
https://github.com/Vasu7389/react-project-ideas,35,138977,3216,15.371428571428572,207,3878.885714285714,25063,3,"{'Vasu7389': 24, 'Vasu Awasthi': 10}",{'Rahul Dange': 1},142167,"[{'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': 'fa9228aaa5e63f0724ffd1219b7695e54966feee', 'commitauthor': 'Vasu7389', 'commitauthoremail': '52382687+Vasu7389@users.noreply.github.com', 'commitauthordate': '2022-09-15 11:02:12', 'commitauthortimezone': -19800, 'commitlinesadded': 22, 'commitlinesremoved': 0, 'commitinmain': True, 'commitmessage': 'Initial commit'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': '5ac2baa1c5a896bb8a7ee4279b950128e0a29c68', 'commitauthor': 'Vasu7389', 'commitauthoremail': 'awasthivasu.65@gmail.com', 'commitauthordate': '2022-09-15 11:10:13', 'commitauthortimezone': -19800, 'commitlinesadded': 390, 'commitlinesremoved': 0, 'commitinmain': True, 'commitmessage': 'react30 day1 & day2 articles'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': '4cafbfa02cc367541b4a7fb4c0d4b6446b137457', 'commitauthor': 'Vasu7389', 'commitauthoremail': 'awasthivasu.65@gmail.com', 'commitauthordate': '2022-09-15 11:26:56', 'commitauthortimezone': -19800, 'commitlinesadded': 22, 'commitlinesremoved': 0, 'commitinmain': True, 'commitmessage': ""Merge branch 'master' of https://github.com/Vasu7389/react30""}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': '64f1500186b55e9a5fcc249e9f97bd3b58a4efe8', 'commitauthor': 'Vasu7389', 'commitauthoremail': '52382687+Vasu7389@users.noreply.github.com', 'commitauthordate': '2022-09-15 11:42:40', 'commitauthortimezone': -19800, 'commitlinesadded': 0, 'commitlinesremoved': 389, 'commitinmain': True, 'commitmessage': 'Delete day2 directory'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': '2c46cefb703d411c4e6c33cd72e7af9e4c3d32c7', 'commitauthor': 'Vasu7389', 'commitauthoremail': '52382687+Vasu7389@users.noreply.github.com', 'commitauthordate': '2022-09-15 11:42:48', 'commitauthortimezone': -19800, 'commitlinesadded': 0, 'commitlinesremoved': 1, 'commitinmain': True, 'commitmessage': 'Delete day1 directory'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': '859cb16ce970eb8c0bca67ed16c78bfd75041d55', 'commitauthor': 'Vasu7389', 'commitauthoremail': 'awasthivasu.65@gmail.com', 'commitauthordate': '2022-09-15 11:43:43', 'commitauthortimezone': -19800, 'commitlinesadded': 25063, 'commitlinesremoved': 0, 'commitinmain': True, 'commitmessage': 'day1 & day2 added'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': 'f9996d40aa5bcbc86268d930c3c0cc10c2e4387b', 'commitauthor': 'Vasu7389', 'commitauthoremail': 'awasthivasu.65@gmail.com', 'commitauthordate': '2022-09-15 11:46:01', 'commitauthortimezone': -19800, 'commitlinesadded': 1, 'commitlinesremoved': 0, 'commitinmain': True, 'commitmessage': 'added gitignore'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': '101aa444ac9b53874510e2059332144381161122', 'commitauthor': 'Vasu7389', 'commitauthoremail': '52382687+Vasu7389@users.noreply.github.com', 'commitauthordate': '2022-09-15 11:48:43', 'commitauthortimezone': -19800, 'commitlinesadded': 3, 'commitlinesremoved': 1, 'commitinmain': True, 'commitmessage': 'Update README.md'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': '1eaa28799994ff234e986638a849ec44ad40d25e', 'commitauthor': 'Vasu7389', 'commitauthoremail': 'awasthivasu.65@gmail.com', 'commitauthordate': '2022-09-15 13:59:48', 'commitauthortimezone': -19800, 'commitlinesadded': 12683, 'commitlinesremoved': 1, 'commitinmain': True, 'commitmessage': 'day 3 challenge added'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': '2338ae1dc0de8f3d83b0fafeef2969c756625f0b', 'commitauthor': 'Vasu7389', 'commitauthoremail': 'awasthivasu.65@gmail.com', 'commitauthordate': '2022-09-15 14:00:03', 'commitauthortimezone': -19800, 'commitlinesadded': 3, 'commitlinesremoved': 1, 'commitinmain': True, 'commitmessage': ""Merge branch 'master' of https://github.com/Vasu7389/react30""}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': 'b72ef01de0cca9bf26a34cbc66a6070cf6e0917a', 'commitauthor': 'Vasu7389', 'commitauthoremail': 'awasthivasu.65@gmail.com', 'commitauthordate': '2022-09-16 13:29:28', 'commitauthortimezone': -19800, 'commitlinesadded': 17648, 'commitlinesremoved': 0, 'commitinmain': True, 'commitmessage': 'day 4 added'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': '6e382170eee2e1c5a8ca1adbfecf1768ba94630e', 'commitauthor': 'Vasu7389', 'commitauthoremail': 'awasthivasu.65@gmail.com', 'commitauthordate': '2022-09-18 04:35:18', 'commitauthortimezone': -19800, 'commitlinesadded': 12791, 'commitlinesremoved': 0, 'commitinmain': True, 'commitmessage': 'day 5 added'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': '3d7d1428aa196e256c1d7046ff43a6fe17a48bc0', 'commitauthor': 'Vasu7389', 'commitauthoremail': 'awasthivasu.65@gmail.com', 'commitauthordate': '2022-09-21 07:06:44', 'commitauthortimezone': -19800, 'commitlinesadded': 12574, 'commitlinesremoved': 0, 'commitinmain': True, 'commitmessage': 'day6 added'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': 'd18b5e88b2be9b02000ee86d0611b4ada53c27c7', 'commitauthor': 'Vasu7389', 'commitauthoremail': 'awasthivasu.65@gmail.com', 'commitauthordate': '2022-10-24 05:15:01', 'commitauthortimezone': -19800, 'commitlinesadded': 12500, 'commitlinesremoved': 0, 'commitinmain': True, 'commitmessage': 'day7 challenge added'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': '64288c91c536ca3652b36492f344e66b8da45714', 'commitauthor': 'Vasu7389', 'commitauthoremail': 'awasthivasu.65@gmail.com', 'commitauthordate': '2022-10-24 05:17:02', 'commitauthortimezone': -19800, 'commitlinesadded': 192, 'commitlinesremoved': 0, 'commitinmain': True, 'commitmessage': 'day7 assets added'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': 'f29058f550969c132a487c41cc8c2b34b65b4b39', 'commitauthor': 'Vasu7389', 'commitauthoremail': 'awasthivasu.65@gmail.com', 'commitauthordate': '2022-10-25 13:16:05', 'commitauthortimezone': -19800, 'commitlinesadded': 12631, 'commitlinesremoved': 0, 'commitinmain': True, 'commitmessage': 'day8 challenge added'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': '5e04bb07bef7af84601c67cb57e329c84429a15b', 'commitauthor': 'Vasu7389', 'commitauthoremail': 'awasthivasu.65@gmail.com', 'commitauthordate': '2022-10-25 13:28:54', 'commitauthortimezone': -19800, 'commitlinesadded': 2, 'commitlinesremoved': 2, 'commitinmain': True, 'commitmessage': 'about us added'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': 'e98aae0c5c3e2f075e5f80635905e05fc1e8484c', 'commitauthor': 'Vasu7389', 'commitauthoremail': 'awasthivasu.65@gmail.com', 'commitauthordate': '2022-10-25 13:30:09', 'commitauthortimezone': -19800, 'commitlinesadded': 1, 'commitlinesremoved': 1, 'commitinmain': True, 'commitmessage': 'codinn link added'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': 'b82a6c77d28603db991650cd8efdfbfc8791e9e3', 'commitauthor': 'Vasu7389', 'commitauthoremail': 'awasthivasu.65@gmail.com', 'commitauthordate': '2022-10-27 13:01:42', 'commitauthortimezone': -19800, 'commitlinesadded': 1, 'commitlinesremoved': 1, 'commitinmain': True, 'commitmessage': 'readme updated'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': '7c77dcc71e89720a82dc1d1f373e15e49bdeee25', 'commitauthor': 'Vasu7389', 'commitauthoremail': 'awasthivasu.65@gmail.com', 'commitauthordate': '2022-10-28 17:03:35', 'commitauthortimezone': -19800, 'commitlinesadded': 14200, 'commitlinesremoved': 0, 'commitinmain': True, 'commitmessage': 'day9 added'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': '8c6fe6d1c8d97cfd80308fabd5e130fad068616b', 'commitauthor': 'Vasu Awasthi', 'commitauthoremail': '52382687+Vasu7389@users.noreply.github.com', 'commitauthordate': '2022-10-29 05:35:12', 'commitauthortimezone': -19800, 'commitlinesadded': 51, 'commitlinesremoved': 1, 'commitinmain': True, 'commitmessage': 'readme updated'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': '0dcafd74b0dbdb8b1d4fca4ba0c5e7822838b4ed', 'commitauthor': 'Vasu7389', 'commitauthoremail': 'awasthivasu.65@gmail.com', 'commitauthordate': '2022-10-29 05:40:10', 'commitauthortimezone': -19800, 'commitlinesadded': 0, 'commitlinesremoved': 2769, 'commitinmain': True, 'commitmessage': 'removed all the assets'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': '3473147f768650cf3723c1337cc57358ae6c1112', 'commitauthor': 'Vasu7389', 'commitauthoremail': 'awasthivasu.65@gmail.com', 'commitauthordate': '2022-11-09 14:01:37', 'commitauthortimezone': -19800, 'commitlinesadded': 19, 'commitlinesremoved': 9, 'commitinmain': True, 'commitmessage': 'demo link updated'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': '4981c82c2b2226af3a38727e6fb79e5d472e10ae', 'commitauthor': 'Vasu Awasthi', 'commitauthoremail': '52382687+Vasu7389@users.noreply.github.com', 'commitauthordate': '2022-11-12 11:12:43', 'commitauthortimezone': -19800, 'commitlinesadded': 128, 'commitlinesremoved': 0, 'commitinmain': True, 'commitmessage': 'Create CODE_OF_CONDUCT.md'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': '9aa6220baf9a211f0baec40f07ac52fd02af58c7', 'commitauthor': 'Vasu Awasthi', 'commitauthoremail': '52382687+Vasu7389@users.noreply.github.com', 'commitauthordate': '2022-11-12 11:59:58', 'commitauthortimezone': -19800, 'commitlinesadded': 30, 'commitlinesremoved': 0, 'commitinmain': True, 'commitmessage': 'Create CONTRIBUTING.md'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': '8d01013c47a6dffa98d7b786e456e2719601a701', 'commitauthor': 'Vasu Awasthi', 'commitauthoremail': '52382687+Vasu7389@users.noreply.github.com', 'commitauthordate': '2022-11-12 12:02:00', 'commitauthortimezone': -19800, 'commitlinesadded': 5, 'commitlinesremoved': 0, 'commitinmain': True, 'commitmessage': 'Create SECURITY.md'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': '3c2926b0c91c7195c286b93523cd23d70ab64db9', 'commitauthor': 'Vasu Awasthi', 'commitauthoremail': '52382687+Vasu7389@users.noreply.github.com', 'commitauthordate': '2022-11-13 04:26:39', 'commitauthortimezone': -19800, 'commitlinesadded': 9, 'commitlinesremoved': 9, 'commitinmain': True, 'commitmessage': 'Update README.md'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': '09275edf66f1064b2186058b00f639c873dad9d6', 'commitauthor': 'Vasu Awasthi', 'commitauthoremail': '52382687+Vasu7389@users.noreply.github.com', 'commitauthordate': '2022-11-15 13:51:26', 'commitauthortimezone': -19800, 'commitlinesadded': 2, 'commitlinesremoved': 0, 'commitinmain': True, 'commitmessage': 'Update README.md'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': 'd3d7b9090ccc35029829acecb78dd421894af0c4', 'commitauthor': 'Vasu7389', 'commitauthoremail': 'awasthivasu.65@gmail.com', 'commitauthordate': '2022-11-17 12:22:14', 'commitauthortimezone': -19800, 'commitlinesadded': 17970, 'commitlinesremoved': 0, 'commitinmain': True, 'commitmessage': 'day10 added'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': '7e1011cdcdec4dd7c4a3efce8899aade2afb51ae', 'commitauthor': 'Vasu7389', 'commitauthoremail': 'awasthivasu.65@gmail.com', 'commitauthordate': '2022-11-17 12:49:50', 'commitauthortimezone': -19800, 'commitlinesadded': 0, 'commitlinesremoved': 0, 'commitinmain': True, 'commitmessage': 'folder renamed'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': '0f7ad7c042c78d09dbcee0c0030ab210ab2bfde6', 'commitauthor': 'Vasu Awasthi', 'commitauthoremail': '52382687+Vasu7389@users.noreply.github.com', 'commitauthordate': '2022-11-17 14:14:38', 'commitauthortimezone': -19800, 'commitlinesadded': 14, 'commitlinesremoved': 9, 'commitinmain': True, 'commitmessage': 'Update README.md'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': '435cbb49a1dd17cbeb572c37f421ec751582dea0', 'commitauthor': 'Vasu Awasthi', 'commitauthoremail': '52382687+Vasu7389@users.noreply.github.com', 'commitauthordate': '2022-11-18 15:25:54', 'commitauthortimezone': -19800, 'commitlinesadded': 10, 'commitlinesremoved': 10, 'commitinmain': True, 'commitmessage': 'Update README.md'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': 'daa9e5befb5838f0b40d168f7853ce790342f036', 'commitauthor': 'Vasu Awasthi', 'commitauthoremail': '52382687+Vasu7389@users.noreply.github.com', 'commitauthordate': '2022-12-13 07:04:14', 'commitauthortimezone': -19800, 'commitlinesadded': 10, 'commitlinesremoved': 10, 'commitinmain': True, 'commitmessage': 'Project demo path updated'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': '197ef4010560447e76d31899fd572b9d15474682', 'commitauthor': 'Vasu Awasthi', 'commitauthoremail': '52382687+Vasu7389@users.noreply.github.com', 'commitauthordate': '2023-02-24 10:14:04', 'commitauthortimezone': -19800, 'commitlinesadded': 1, 'commitlinesremoved': 1, 'commitinmain': True, 'commitmessage': 'Update README.md'}, {'url': 'https://github.com/Vasu7389/react-project-ideas', 'commithash': '0496cf49a5bac64c4a5a07371f7fcbb9ac6df195', 'commitauthor': 'Rahul Dange', 'commitauthoremail': 'rahuldangeofficial@gmail.com', 'commitauthordate': '2023-07-09 06:19:46', 'commitauthortimezone': -19800, 'commitlinesadded': 1, 'commitlinesremoved': 1, 'commitinmain': True, 'commitmessage': 'Fix typo at line 70\n\nMT -> MIT'}]"
        """;

        // Create a MockMultipartFile to simulate a file upload
        MockMultipartFile file = new MockMultipartFile("file", "test.csv",
                "text/csv", csvContent.getBytes(StandardCharsets.UTF_8));

        CSV csv = restAPI.ProcessCSVFile(file);
        assertEquals("https://github.com/Vasu7389/react-project-ideas", csv.getUrl());
        assertDoesNotThrow(() -> restAPI.ProcessCSVFile(file));
    }
}
